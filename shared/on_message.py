from datetime import datetime
from discord import Message
from discord.ext.commands import Cog, Bot
from assets.functions import AutoMod, Currency


class OnMessageCog(Cog):
    def __init__(self, bot: Bot):
        self.bot = bot

    @Cog.listener()
    async def on_message(self, message: Message):
        starboarda_channels = {
            1228074075113652267,
            1003589695910973480,
            1110173625778196581,
            1054091901852209252,
            1054091728816181328,
            1054091953433747539,
            1082393894190321835,
            1200441886998011944,
            1194722939342426306,
            1194723009563476089,
            985976349615337543,
            1063901648759562300,
            1055052536626810880,
            1118628112364744834,
            1098326250306683031,
            1187501270865559592,
            985976707569844274,
            985976752797003857,
            985980079521808495,
            985977045983039539,
            985980170190061658,
            985977073115996272,
            985976623679549512,
            1153759719144554576,
            1061401929646887072,
            1166094615359791254,
            985977457125511260,
            1060536485708836975,
            1062292867659341844,
            985983659196706876,
            1195117077560840202,
            985976689794375730,
            985983497799868518,
            985976738670604380,
            1063536516737015869,
            985977128656994304,
            985980118352670740,
            985983699856277534,
            1060242356684726322,
            985977212895387710,
            1081267471312498698,
            985976815485067364,
            1194628336568250480,
            985977100802605146,
            985976963686596658,
            1194628596527018147,
            1075188986873643068,
            986295590793117736,
            985976653270356060,
            1086757616895672490,
            986295749958582342,
            986295780719611994,
            985976670680940575,
            986295623101845595,
            1194632376366682223,
            1181586771738374245,
            1070779894994305136,
            1076811116950339614,
            1076811157278556251,
            1166095137236066475,
            1194634325581385836,
            1194635028135677972,
            1194633043995021383,
            1194633860357558302,
            1194634102360522912,
            1194634486860763226,
            1115726593457926294,
        }
        advertising_channels = {
            1239494034007920680,
            1239497333658357771,
            1239493932811943936,
            1239493988180951050,
            1239497411903356990,
            1239497833707733053,
            1239497884995551262,
            1239497907611107359,
            1239497942147137536,
            1239498015085957191,
            1239498049353416765,
            1239498297908002900,
            1239498385870819352,
            1241276362359050330,
            1241276387348844554,
            1239500814301532233,
            1239501940971274291,
            1239502571727487017,
            1239503912285765682,
            1239504433465790524,
            1239504190926094346,
            1239502832533635143,
            1239502264872472586,
            1239503470453723186,
            1239502181418143744,
            1240194116810178650,
            1240196579466412052,
            1239505025261375498,
            1239505121465864202,
            1239505374361550889,
            1239505535662030860,
        }

        if (
            message.guild.id == 974028573893595146
            and message.channel.id in starboarda_channels
        ):
            if len(message.attachments) >= 1:
                await message.add_reaction(":mhxaLove:1174261737697050625")
                if message.channel.id in {
                    1115726593457926294,
                    1003589695910973480,
                    1110173625778196581,
                    1054091901852209252,
                    1054091728816181328,
                    1054091953433747539,
                    1082393894190321835,
                }:
                    await message.publish()
                    return

        if (
            message.guild.id == 925790259160166460
            and message.channel.id in advertising_channels
        ):
            await Currency(message.author).add_credits(2)
            if datetime.today().weekday() >= 5:
                await Currency(message.author).add_credits(3)
            await message.add_reaction("<:HAZEcoin:1209238914041118721>")
            return

        await AutoMod(self.bot, message).process_automod()


async def setup(bot: Bot):
    await bot.add_cog(OnMessageCog(bot))
